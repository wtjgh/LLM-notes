# è¯„ä¼°ä½¿ç”¨æ‰‹å†Œ
## å¿«é€Ÿå¼€å§‹
åœ¨ OpenCompass ä¸­ï¼Œæ¯ä¸ªè¯„ä¼°ä»»åŠ¡ç”±å¾…è¯„ä¼°çš„æ¨¡å‹å’Œæ•°æ®é›†ç»„æˆã€‚è¯„ä¼°çš„å…¥å£ç‚¹æ˜¯ run.pyã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæˆ–é…ç½®æ–‡ä»¶é€‰æ‹©è¦æµ‹è¯•çš„æ¨¡å‹å’Œæ•°æ®é›†ã€‚run.pyå°±ä½äºOpenCompassä¸»ç›®å½•ä¸‹ã€‚
æœ€ç®€å•çš„å¼€å¯è¯„ä¼°æ–¹å¼ï¼Œæ˜¯ç”¨æˆ·é€šè¿‡ `--models MODEL1 MODEL2 ...` å’Œ `--datasets DATASET1 DATASET2 ...` æ¥æŒ‡å®šæ¨¡å‹å’Œæ•°æ®é›†:

  ```bash
  python run.py --models hf_opt_350m hf_opt_125m --datasets siqa_gen winograd_ppl
  ```
å¦‚ä¸Šæ‰€ç¤ºï¼Œè¯„ä¼°ä½¿ç”¨çš„æ¨¡å‹æ˜¯hf_opt_350mä¸hf_opt_125mï¼Œä½¿ç”¨çš„æ•°æ®é›†ä¸ºsiqa_genä¸winograd_pplã€‚åœ¨è¿™é‡Œä¸ºäº†æ–¹ä¾¿å¤§å®¶çš„ä½¿ç”¨ï¼Œæˆ‘å°†ä¹‹å‰æåˆ°å‡ ç§è¯„ä¼°æ¨¡å¼çš„å¯åŠ¨å‘½ä»¤æä¾›ç»™å¤§å®¶ï¼Œè¿™é‡Œä»¥Qwen-chat 7Bæ¨¡å‹ä¸ºä¾‹å­ã€‚
**æ³¨æ„ï¼šå¦‚æœæƒ³æµ‹è¯•çš„æ¨¡å‹è·¯å¾„ä¸ºè‡ªå·±ç›®å½•ä¸‹çš„ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢æ¨¡å‹å‚æ•°é…ç½®å¿«é€Ÿå®Œæˆè·¯å¾„ä¿®æ”¹ã€‚**
é€šç”¨èƒ½åŠ›æ¶µç›–è€ƒè¯•èƒ½åŠ›ã€çŸ¥è¯†èƒ½åŠ›ã€è¯­è¨€èƒ½åŠ›ã€ç†è§£èƒ½åŠ›ã€æ¨ç†èƒ½åŠ›ã€å®‰å…¨èƒ½åŠ›ï¼Œå…±è®¡å…­å¤§ç»´åº¦æ„é€ ç«‹ä½“å…¨é¢çš„æ¨¡å‹èƒ½åŠ›è¯„ä»·ä½“ç³»ã€‚
### å•ä¸€è¯„ä¼°
åªå¯¹å…­å¤§é€šç”¨èƒ½åŠ›ä¹‹ä¸€è¿›è¡Œè¯„ä¼°å·¥ä½œï¼Œå¹¶ä¸”åªè¯„ä¼°è¯¥èƒ½åŠ›å¯¹åº”çš„ä¸€ä¸ªæ•°æ®é›†ã€‚è¯„ä¼°è€—æ—¶ç›¸å¯¹æœ€å°‘ã€‚
#### è¯­è¨€
  ```bash
  python run.py --models hf_qwen_7b_chat --datasets winogrande_ppl
  ```
#### çŸ¥è¯†
```bash
  python run.py --models hf_qwen_7b_chat --datasets commonsenseqa_ppl
  ```
#### æ¨ç†
```bash
  python run.py --models hf_qwen_7b_chat --datasets siqa_ppl
  ```
#### è€ƒè¯•
```bash
  python run.py --models hf_qwen_7b_chat --datasets ceval_ppl
  ```
#### ç†è§£
```bash
  python run.py --models hf_qwen_7b_chat --datasets drop_gen
  ```
#### å®‰å…¨
```bash
  python run.py --models hf_qwen_7b_chat --datasets jigsawmultilingual_clp
  ```
### åŸºç¡€è¯„ä¼°
å¯¹å…­å¤§é€šç”¨èƒ½åŠ›éƒ½è¿›è¡Œè¯„ä¼°ï¼Œä½†åªè¯„ä¼°æ¯ä¸€ä¸ªèƒ½åŠ›å¯¹åº”çš„ä¸€ä¸ªæ•°æ®é›†ã€‚è¯„ä¼°è€—æ—¶ä¸­ç­‰ã€‚
  ```bash
  python run.py --models hf_qwen_7b_chat --datasets winogrande_ppl commonsenseqa_ppl siqa_ppl ceval_ppl drop_gen jigsawmultilingual_clp
  ```
### å…¨é¢è¯„ä¼°
å¯¹å…­å¤§é€šç”¨èƒ½åŠ›éƒ½è¿›è¡Œè¯„ä¼°ï¼Œå¹¶ä¸”è¯„ä¼°æ¯ä¸€ä¸ªèƒ½åŠ›å¯¹åº”çš„æ¯ä¸€ä¸ªæ•°æ®é›†ã€‚è¯„ä¼°è€—æ—¶ç›¸å¯¹æœ€å¤šã€‚æš‚æ—¶ä¸æä¾›ï¼Œè¯„ä¼°è€—æ—¶è¿‡ä¹…ã€‚
## æ¨¡å‹å‚æ•°é…ç½®
å¯¹äºæ¨¡å‹å‚æ•°é…ç½®ï¼Œä¸»è¦é…ç½®çš„æ˜¯æ¨¡å‹å‚æ•°çš„è·¯å¾„ï¼Œtokenizerçš„è·¯å¾„ä»¥åŠå¾®è°ƒåæ¨¡å‹çš„è·¯å¾„ã€‚è°ƒæ•´è¿™äº›å‚æ•°çš„ä½ç½®åœ¨opencompass/configs/models/ç›®å½•ä¸‹ã€‚ä»¥Qwen-chat 7Bæ¨¡å‹ä¸ºä¾‹å­ï¼Œ
å…¶å‚æ•°çš„ä½ç½®åœ¨opencompass/configs/models/qwen/hf_qwen_7b_chat.py
```python
models = [
    dict(
        type=HuggingFaceCausalLM,
        abbr='qwen-7b-chat-hf',
        path="/ssd/ssli/Qwen/Qwen-7B-Chat",                 #æ¨¡å‹å‚æ•°çš„è·¯å¾„
        tokenizer_path='/ssd/ssli/Qwen/Qwen-7B-Chat',       #tokenizerçš„è·¯å¾„
        peft_path='/ssd/tjwu/output_qwen/checkpoint-35000', #å¾®è°ƒåæ¨¡å‹çš„è·¯å¾„
        model_kwargs=dict(
            device_map='auto',
            trust_remote_code=True
        ),
        tokenizer_kwargs=dict(
            padding_side='left',
            truncation_side='left',
            trust_remote_code=True,
            use_fast=False,),
        pad_token_id=151643,
        max_out_len=100,
        max_seq_len=2048,
        batch_size=24,
        meta_template=_meta_template,
        run_cfg=dict(num_gpus=4, num_procs=1),
    )
]
```
## æ•°æ®é›†æ”¯æŒ
ç›®å‰æ”¯æŒçš„æ•°æ®é›†å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼Œåç»­ä¼šä¸æ–­æ›´æ–°ã€‚
<table align="center">
  <tbody>
    <tr align="center" valign="bottom">
      <td>
        <b>è¯­è¨€</b>
      </td>
      <td>
        <b>çŸ¥è¯†</b>
      </td>
      <td>
        <b>æ¨ç†</b>
      </td>
      <td>
        <b>è€ƒè¯•</b>
      </td>
      <td>
        <b>ç†è§£</b>
      </td>
      <td>
        <b>å®‰å…¨</b>
      </td>
    </tr>
    <tr valign="top">
      <td>
<details open>
<summary><b>å­—è¯é‡Šä¹‰</b></summary>

- WiC
- SummEdits

</details>

<details open>
<summary><b>æˆè¯­ä¹ è¯­</b></summary>

- CHID

</details>

<details open>
<summary><b>è¯­ä¹‰ç›¸ä¼¼åº¦</b></summary>

- AFQMC
- BUSTM

</details>

<details open>
<summary><b>æŒ‡ä»£æ¶ˆè§£</b></summary>

- CLUEWSC
- WSC
- WinoGrande

</details>

<details open>
<summary><b>ç¿»è¯‘</b></summary>

- Flores
- IWSLT2017

</details>

<details open>
<summary><b>å¤šè¯­ç§é—®ç­”</b></summary>

- TyDi-QA
- XCOPA

</details>

<details open>
<summary><b>å¤šè¯­ç§æ€»ç»“</b></summary>

- XLSum

</details>
      </td>
      <td>
<details open>
<summary><b>çŸ¥è¯†é—®ç­”</b></summary>

- BoolQ
- CommonSenseQA
- NaturalQuestions
- TriviaQA

</details>
      </td>
      <td>
<details open>
<summary><b>æ–‡æœ¬è•´å«</b></summary>

- CMNLI
- OCNLI
- OCNLI_FC
- AX-b
- AX-g
- CB
- RTE
- ANLI

</details>

<details open>
<summary><b>å¸¸è¯†æ¨ç†</b></summary>

- StoryCloze
- COPA
- ReCoRD
- HellaSwag
- PIQA
- SIQA

</details>

<details open>
<summary><b>æ•°å­¦æ¨ç†</b></summary>

- MATH
- GSM8K

</details>

<details open>
<summary><b>å®šç†åº”ç”¨</b></summary>

- TheoremQA
- StrategyQA
- SciBench

</details>

<details open>
<summary><b>ç»¼åˆæ¨ç†</b></summary>

- BBH

</details>
      </td>
      <td>
<details open>
<summary><b>åˆä¸­/é«˜ä¸­/å¤§å­¦/èŒä¸šè€ƒè¯•</b></summary>

- C-Eval
- AGIEval
- MMLU
- GAOKAO-Bench
- CMMLU
- ARC
- Xiezhi

</details>

<details open>
<summary><b>åŒ»å­¦è€ƒè¯•</b></summary>

- CMB

</details>
      </td>
      <td>
<details open>
<summary><b>é˜…è¯»ç†è§£</b></summary>

- C3
- CMRC
- DRCD
- MultiRC
- RACE
- DROP
- OpenBookQA
- SQuAD2.0

</details>

<details open>
<summary><b>å†…å®¹æ€»ç»“</b></summary>

- CSL
- LCSTS
- XSum
- SummScreen

</details>

<details open>
<summary><b>å†…å®¹åˆ†æ</b></summary>

- EPRSTMT
- LAMBADA
- TNEWS

</details>

<details open>
<summary><b>é•¿æ–‡æœ¬ç†è§£</b></summary>

- LEval
- LongBench
- GovReports
- NarrativeQA
- Qasper

</details>
      </td>
      <td>
<details open>
<summary><b>å®‰å…¨</b></summary>

- CivilComments
- CrowsPairs
- CValues
- JigsawMultilingual
- TruthfulQA

</details>
<details open>
<summary><b>å¥å£®æ€§</b></summary>

- AdvGLUE

</details>
      </td>
    </tr>
</td>
    </tr>
  </tbody>
</table>

<p align="right"><a href="#top">ğŸ”è¿”å›é¡¶éƒ¨</a></p>
